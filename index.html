<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bandon Dunes Golf Trip Summary</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
            background-color: #fff;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .card {
            background-color: #fff;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .table-auto {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }
        .table-auto th, .table-auto td {
            padding: 0.75rem;
            border-bottom: 1px solid #e2e8f0;
            text-align: left;
        }
        .table-auto th {
            background-color: #f8fafc;
            font-weight: 600;
            color: #4a5568;
            text-transform: uppercase;
            font-size: 0.875rem;
        }
        .table-auto tr:last-child td {
            border-bottom: none;
        }
        .table-auto tbody tr:hover {
            background-color: #f0f4f8;
        }
        h1 {
            font-size: 2.25rem;
            margin-bottom: 1.5rem;
        }
        h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        h3 {
            font-size: 1.25rem;
            margin-bottom: 1rem;
        }
        .flex-col.md\:flex-row {
            flex-direction: column;
        }
        @media (min-width: 768px) {
            .flex-col.md\:flex-row {
                flex-direction: row;
            }
            .flex-1.md\:w-1\/2 {
                width: 50%;
            }
        }
        .player-handicap-row td {
            background-color: #e0f2fe;
        }
        .highlight-player {
            background-color: #fef08a;
            padding: 0 0.25rem;
            border-radius: 0.25rem;
        }
        .spacing-row td {
            height: 1rem;
            border-bottom: none;
        }
        .last-tee-time-of-day td {
            border-bottom: 2px solid #a0a0a0;
        }
        .tab-button {
            padding: 0.75rem 1.5rem;
            border-bottom: 2px solid transparent;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        .tab-button.active {
            border-color: #10b981;
            color: #10b981;
        }
        .tab-button:hover {
            color: #059669;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .caddy-player-highlight {
            background-color: #d1fae5;
        }
        .team-header {
            background-color: #6ee7b7;
            font-size: 1.125rem;
            font-weight: 700;
        }
        .caddy-summary-separator {
            border-bottom: 2px solid #a0a0a0;
        }
        .winning-team-highlight {
            background-color: #86efac;
            font-weight: bold;
        }
        .daily-flow-table td {
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
        }
        .daily-flow-table th {
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
        }
    </style>
</head>
<body class="p-4 bg-gray-100 min-h-screen flex items-center justify-center">
    <div class="container bg-white rounded-xl shadow-lg p-6 md:p-8 lg:p-10">
        <h1 class="text-3xl md:text-4xl font-bold text-green-800 mb-8 text-left" id="main-trip-summary-title">Bandon Dunes Golf Trip Summary</h1>

        <div class="flex border-b border-gray-200 mb-6">
            <button id="tab-summary" class="tab-button active">Trip Summary</button>
            <button id="tab-caddy" class="tab-button">Caddy Summary</button>
            <button id="tab-caddy-by-tee-time" class="tab-button">Caddy Summary by Tee Time</button>
            <button id="tab-daily-flow" class="tab-button">Daily Flow</button>
        </div>

        <div id="content-summary" class="tab-content active">
            <div class="card mb-6">
                <div class="mb-4 player-select-section w-full md:w-1/2">
                    <label for="player-select" class="block text-lg font-medium text-red-600 mb-2">Select Player:</label>
                    <select id="player-select" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm rounded-md">
                        </select>
                </div>
            </div>

            <div class="flex flex-col md:flex-row gap-6 mb-6">
                <div class="card flex-1 md:w-1/2">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-4">Stableford Points System</h2>
                    <table class="table-auto" id="stableford-table">
                        <thead>
                            <tr>
                                <th class="px-4 py-2">Score Relative to Par</th>
                                <th class="px-4 py-2">Points</th>
                                <th class="px-4 py-2">Score Relative to Par</th>
                                <th class="px-4 py-2">Points</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="border px-4 py-2">Double Eagle (Par 4 or 5)</td>
                                <td class="border px-4 py-2">20</td>
                                <td class="border px-4 py-2">Par</td>
                                <td class="border px-4 py-2">3</td>
                            </tr>
                            <tr>
                                <td class="border px-4 py-2">Hole-in-One</td>
                                <td class="border px-4 py-2">15</td>
                                <td class="border px-4 py-2">Bogey</td>
                                <td class="border px-4 py-2">2</td>
                            </tr>
                            <tr>
                                <td class="border px-4 py-2">Eagle</td>
                                <td class="border px-4 py-2">10</td>
                                <td class="border px-4 py-2">Double Bogey</td>
                                <td class="border px-4 py-2">1</td>
                            </tr>
                            <tr>
                                <td class="border px-4 py-2">Birdie</td>
                                <td class="border px-4 py-2">5</td>
                                <td class="border px-4 py-2">DNF/Triple +</td>
                                <td class="border px-4 py-2">0</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="card flex-1 md:w-1/2">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-4">Notes</h2>
                    <table class="table-auto">
                        <thead>
                            <tr>
                                <th class="px-4 py-2">Note</th>
                            </tr>
                        </thead>
                        <tbody id="notes-table-body">
                            </tbody>
                    </table>
                </div>
            </div>

            <div class="card mt-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Daily Group Gambling</h2>
                <table class="table-auto">
                    <thead>
                        <tr>
                            <th class="px-4 py-2">Item</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="border px-4 py-2">$50 / daily group bet for AM rounds only, afternoon rounds choose your own adventure.</td>
                        </tr>
                        <tr>
                            <td class="border px-4 py-2">There will be six (6), four (4) man teams. $240 payout per person on the winning team ($960 pot divided by 4).</td>
                        </tr>
                        <tr>
                            <td class="border px-4 py-2">Gimmies are okay but don't swipe a 5 foot putt and call it yourself, let the group decide.</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="card">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Tee Time Pairings</h2>
                <div id="tee-time-pairings-container" class="overflow-x-auto">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4" id="current-player-tee-times-title"></h3>
                    <table class="table-auto">
                        <thead>
                            <tr>
                                <th class="px-4 py-2">Date</th>
                                <th class="px-4 py-2">Time</th>
                                <th class="px-4 py-2">Estimated Completion Time</th>
                                <th class="px-4 py-2">Course</th>
                                <th class="px-4 py-2">Caddie</th>
                                <th class="px-4 py-2">Playing Partners (Handicap)</th>
                            </tr>
                        </thead>
                        <tbody id="tee-time-pairings-body">
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card mt-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Daily Pairings</h2>
                <div id="daily-pairings-container" class="overflow-x-auto">
                    <table class="table-auto">
                        <thead>
                            <tr>
                                <th class="px-4 py-2">Date</th>
                                <th class="px-4 py-2">Time</th>
                                <th class="px-4 py-2">Estimated Completion Time</th>
                                <th class="px-4 py-2">Course</th>
                                <th class="px-4 py-2">All Players (Handicap)</th>
                            </tr>
                        </thead>
                        <tbody id="daily-pairings-body">
                            </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="content-caddy" class="tab-content">
            <div class="card mt-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Caddy Summary by Player and Round</h2>
                <div id="caddy-summary-container" class="overflow-x-auto">
                    <table class="table-auto">
                        <thead>
                            <tr id="caddy-summary-header-row">
                                <th class="px-4 py-2">Player</th>
                                </tr>
                        </thead>
                        <tbody id="caddy-summary-body">
                            </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="content-caddy-by-tee-time" class="tab-content">
            <div class="card mt-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Caddy Summary by Tee Time</h2>
                <div id="caddy-tee-time-summary-container" class="overflow-x-auto">
                    <table class="table-auto">
                        <thead>
                            <tr>
                                <th class="px-4 py-2">Date</th>
                                <th class="px-4 py-2">Time</th>
                                <th class="px-4 py-2">Course</th>
                                <th class="px-4 py-2">Players & Caddies</th>
                                <th class="px-4 py-2">Caddy Summary</th>
                            </tr>
                        </thead>
                        <tbody id="caddy-tee-time-summary-body">
                            </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="content-daily-flow" class="tab-content">
            <div class="card mt-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Daily Flow</h2>
                <div id="daily-flow-container" class="overflow-x-auto">
                    <table class="table-auto w-full daily-flow-table">
                        <thead id="daily-flow-header"></thead>
                        <tbody id="daily-flow-body"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="content-scoring-8-20" class="tab-content">
            <div class="card mt-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Daily Scoring (8/20)</h2>
                <div id="scoring-container-8-20" class="overflow-x-auto">
                    <table class="table-auto">
                        <thead>
                            <tr>
                                <th class="px-4 py-2">Team</th>
                                <th class="px-4 py-2">Player</th>
                                <th class="px-4 py-2">Handicap</th>
                                <th class="px-4 py-2">8/20 Score</th>
                                <th class="px-4 py-2">Team Total</th>
                            </tr>
                        </thead>
                        <tbody id="scoring-body-8-20">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div id="content-scoring-8-21" class="tab-content">
            <div class="card mt-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Daily Scoring (8/21)</h2>
                <div id="scoring-container-8-21" class="overflow-x-auto">
                    <table class="table-auto">
                        <thead>
                            <tr>
                                <th class="px-4 py-2">Team</th>
                                <th class="px-4 py-2">Player</th>
                                <th class="px-4 py-2">Handicap</th>
                                <th class="px-4 py-2">8/21 Score</th>
                                <th class="px-4 py-2">Team Total</th>
                            </tr>
                        </thead>
                        <tbody id="scoring-body-8-21">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div id="content-scoring-8-22" class="tab-content">
            <div class="card mt-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Daily Scoring (8/22)</h2>
                <div id="scoring-container-8-22" class="overflow-x-auto">
                    <table class="table-auto">
                        <thead>
                            <tr>
                                <th class="px-4 py-2">Team</th>
                                <th class="px-4 py-2">Player</th>
                                <th class="px-4 py-2">Handicap</th>
                                <th class="px-4 py-2">8/22 Score</th>
                                <th class="px-4 py-2">Team Total</th>
                            </tr>
                        </thead>
                        <tbody id="scoring-body-8-22">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div id="content-scoring-8-23" class="tab-content">
            <div class="card mt-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Daily Scoring (8/23)</h2>
                <div id="scoring-container-8-23" class="overflow-x-auto">
                    <table class="table-auto">
                        <thead>
                            <tr>
                                <th class="px-4 py-2">Team</th>
                                <th class="px-4 py-2">Player</th>
                                <th class="px-4 py-2">Handicap</th>
                                <th class="px-4 py-2">8/23 Score</th>
                                <th class="px-4 py-2">Team Total</th>
                            </tr>
                        </thead>
                        <tbody id="scoring-body-8-23">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div id="content-scoring-8-24" class="tab-content">
            <div class="card mt-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Daily Scoring (8/24)</h2>
                <div id="scoring-container-8-24" class="overflow-x-auto">
                    <table class="table-auto">
                        <thead>
                            <tr>
                                <th class="px-4 py-2">Team</th>
                                <th class="px-4 py-2">Player</th>
                                <th class="px-4 py-2">Handicap</th>
                                <th class="px-4 py-2">8/24 Score</th>
                                <th class="px-4 py-2">Team Total</th>
                            </tr>
                        </thead>
                        <tbody id="scoring-body-8-24">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Raw CSV data for golf pairings - Rebuilt from the latest Golf Pairings CSV file.
        const csvData = `Date,Time,Course,Player1,Player2,Player3,Player4,Player5,Notes
2025-08-20,2:40 p.m.,Bandon Dunes,Cory Higgins,Kevin Newell,Mike Newell,Rob Small,,
2025-08-20,2:50 p.m.,Bandon Dunes,Zach Deines,Johnathn Resetar,Ryan Hohn,Jacob Emert,,
2025-08-20,3:00 p.m.,Bandon Dunes,Bryan Wolfe,Matt Akers,Paul Parker,Andrew Akers,,
2025-08-20,3:10 p.m.,Bandon Dunes,Kevan Oyama,Bob Owlett,Nick Zangardi,James Adolfson,,
2025-08-20,3:20 p.m.,Bandon Dunes,Vikas Bhasin,Daniel Passino,Charlie Hildebrand,Hisham Sayeedi,,
2025-08-20,6:45 p.m.,Shorty's,Brandon Itaoka,Cory Micheel,AD Hoffman,Will Quarles,,
2025-08-21,7:30 a.m.,Pacific Dunes,Vikas Bhasin,Charlie Hildebrand,Hisham Sayeedi,Daniel Passino,,
2025-08-21,7:40 a.m.,Pacific Dunes,Cory Higgins,Matt Akers,Andrew Akers,James Adolfson,,
2025-08-21,7:50 a.m.,Pacific Dunes,Bob Owlett,Kevin Newell,Mike Newell,Rob Small,,
2025-08-21,8:00 a.m.,Pacific Dunes,Kevan Oyama,Zach Deines,Nick Zangardi,Johnathn Resetar,,
2025-08-21,8:10 a.m.,Pacific Dunes,Brandon Itaoka,Ryan Hohn,Paul Parker,Jacob Emert,,
2025-08-21,8:20 a.m.,Pacific Dunes,AD Hoffman,Bryan Wolfe,Will Quarles,Cory Micheel,,
2025-08-21,1:10 p.m.,Bandon Dunes,Charlie Hildebrand,Hisham Sayeedi,Daniel Passino,Vikas Bhasin,,REPLAY
2025-08-21,1:20 p.m.,Bandon Dunes,Kevan Oyama,Cory Higgins,Jacob Emert,Mike Newell,,REPLAY
2025-08-21,1:30 p.m.,Bandon Dunes,Zach Deines,Paul Parker,Johnathn Resetar,James Adolfson,,REPLAY
2025-08-21,1:40 p.m.,Bandon Dunes,Cory Micheel,Bob Owlett,Will Quarles,AD Hoffman,,REPLAY
2025-08-21,1:50 p.m.,Bandon Dunes,Ryan Hohn,Nick Zangardi,Bryan Wolfe,,,REPLAY
2025-08-21,2:15 p.m.,Bandon Preserve,Matt Akers,Andrew Akers,Kevin Newell,Rob Small,Brandon Itaoka,Bill to individuals
2025-08-22,7:30 a.m.,Bandon Trails,AD Hoffman,Bryan Wolfe,Bob Owlett,Cory Micheel,,
2025-08-22,7:40 a.m.,Bandon Trails,Cory Higgins,Brandon Itaoka,Ryan Hohn,Paul Parker,,
2025-08-22,7:50 a.m.,Bandon Trails,Mike Newell,Nick Zangardi,Kevin Newell,Rob Small,,
2025-08-22,8:10 a.m.,Bandon Trails,Vikas Bhasin,Daniel Passino,Hisham Sayeedi,Charlie Hildebrand,,
2025-08-22,8:20 a.m.,Bandon Trails,Kevan Oyama,Matt Akers,Andrew Akers,Will Quarles,,
2025-08-22,1:10 p.m.,Pacific Dunes,Cory Higgins,Vikas Bhasin,Cory Micheel,Mike Newell,,REPLAY
2025-08-22,1:20 p.m.,Pacific Dunes,Bob Owlett,Nick Zangardi,Jacob Emert,Zach Deines,,REPLAY
2025-08-22,1:30 p.m.,Pacific Dunes,James Adolfson,AD Hoffman,Bryan Wolfe,Will Quarles,,REPLAY
2025-08-22,1:40 p.m.,Pacific Dunes,Kevan Oyama,Johnathn Resetar,,,REPLAY
2025-08-22,2:15 p.m.,Shorty's,Brandon Itaoka,Ryan Hohn,Paul Parker,Charlie Hildebrand,Hisham Sayeedi,Bill to individuals
2025-08-22,6:30 p.m.,Shorty's,Daniel Passino,Andrew Akers,Kevin Newell,Rob Small,Matt Akers,Bill to individuals
2025-08-23,7:30 a.m.,Old Macdonald,Kevan Oyama,Mike Newell,Bob Owlett,Nick Zangardi,,
2025-08-23,7:40 a.m.,Old Macdonald,Cory Higgins,Brandon Itaoka,Jacob Emert,Zach Deines,,
2025-08-23,7:50 a.m.,Old Macdonald,Rob Small,Matt Akers,Andrew Akers,Kevin Newell,,
2025-08-23,8:00 a.m.,Old Macdonald,Johnathn Resetar,Ryan Hohn,Paul Parker,James Adolfson,,
2025-08-23,8:10 a.m.,Old Macdonald,Vikas Bhasin,Daniel Passino,Hisham Sayeedi,Charlie Hildebrand,,
2025-08-23,8:20 a.m.,Old Macdonald,AD Hoffman,Bryan Wolfe,Will Quarles,Cory Micheel,,
2025-08-23,1:10 p.m.,Sheep Ranch,Cory Higgins,Matt Akers,Andrew Akers,Jacob Emert,,REPLAY
2025-08-23,1:20 p.m.,Sheep Ranch,Mike Newell,Kevan Oyama,Nick Zangardi,Bryan Wolfe,,REPLAY
2025-08-23,2:15 p.m.,Bandon Preserve,Kevin Newell,Rob Small,Vikas Bhasin,Charlie Hildebrand,,Bill to individuals
2025-08-24,7:00 a.m.,Sheep Ranch,Kevan Oyama,AD Hoffman,Kevin Newell,Rob Small,,
2025-08-24,7:10 a.m.,Sheep Ranch,Vikas Bhasin,Daniel Passino,Hisham Sayeedi,Charlie Hildebrand,,
2025-08-24,7:20 a.m.,Sheep Ranch,Cory Higgins,Bob Owlett,Mike Newell,Cory Micheel,,
2025-08-24,7:30 a.m.,Sheep Ranch,Zach Deines,Johnathn Resetar,Jacob Emert,Brandon Itaoka,,
2025-08-24,7:40 a.m.,Sheep Ranch,James Adolfson,Ryan Hohn,Nick Zangardi,Paul Parker,,`;
        
        // Caddy data rebuilt from the provided CSV and cross-referenced with the tee time schedule for 100% accuracy.
        const completeCaddyData = {
            "AD Hoffman": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "Non-Carry Strategy Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "Non-Carry Strategy Caddy", "PM": "No Caddy" },
                "2025-08-23": { "AM": "Non-Carry Strategy Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "Non-Carry Strategy Caddy" }
            },
            "Andrew Akers": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-23": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "Not Playing" }
            },
            "Bob Owlett": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "Non-Carry Strategy Caddy", "PM": "No Caddy" },
                "2025-08-23": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "No Caddy" }
            },
            "Brandon Itaoka": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-23": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "No Caddy" }
            },
            "Bryan Wolfe": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "Non-Carry Strategy Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "Non-Carry Strategy Caddy", "PM": "No Caddy" },
                "2025-08-23": { "AM": "Non-Carry Strategy Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "Not Playing" }
            },
            "Charlie Hildebrand": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "Non-Carry Strategy Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "Non-Carry Strategy Caddy", "PM": "No Caddy" },
                "2025-08-23": { "AM": "Non-Carry Strategy Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "Carry Caddy" }
            },
            "Cory Higgins": {
                "2025-08-20": { "PM": "Carry Caddy" },
                "2025-08-21": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "Carry Caddy", "PM": "Carry Caddy" },
                "2025-08-23": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "Carry Caddy" }
            },
            "Cory Micheel": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "Non-Carry Strategy Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "Non-Carry Strategy Caddy", "PM": "Carry Caddy" },
                "2025-08-23": { "AM": "Non-Carry Strategy Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "No Caddy" }
            },
            "Daniel Passino": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "No Caddy", "PM": "Carry Caddy" },
                "2025-08-22": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-23": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "Carry Caddy" }
            },
            "Hisham Sayeedi": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-23": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "Carry Caddy" }
            },
            "Jacob Emert": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "Not Playing", "PM": "No Caddy" },
                "2025-08-23": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "Carry Caddy" }
            },
            "James Adolfson": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "Not Playing", "PM": "No Caddy" },
                "2025-08-23": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "No Caddy" }
            },
            "Johnathn Resetar": {
                "2025-08-20": { "PM": "Carry Caddy" },
                "2025-08-21": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "Not Playing", "PM": "No Caddy" },
                "2025-08-23": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "No Caddy" }
            },
            "Kevan Oyama": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "Carry Caddy", "PM": "Carry Caddy" },
                "2025-08-22": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-23": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "Carry Caddy" }
            },
            "Kevin Newell": {
                "2025-08-20": { "PM": "Carry Caddy" },
                "2025-08-21": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-23": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "Carry Caddy" }
            },
            "Matt Akers": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-23": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "No Caddy" }
            },
            "Mike Newell": {
                "2025-08-20": { "PM": "Carry Caddy" },
                "2025-08-21": { "AM": "Carry Caddy", "PM": "Carry Caddy" },
                "2025-08-22": { "AM": "Carry Caddy", "PM": "Carry Caddy" },
                "2025-08-23": { "AM": "Carry Caddy", "PM": "Carry Caddy" },
                "2025-08-24": { "AM": "Carry Caddy" }
            },
            "Nick Zangardi": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-23": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "No Caddy" }
            },
            "Paul Parker": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "No Caddy", "PM": "Non-Carry Strategy Caddy" },
                "2025-08-22": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-23": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "Non-Carry Strategy Caddy" }
            },
            "Rob Small": {
                "2025-08-20": { "PM": "Carry Caddy" },
                "2025-08-21": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-23": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "Carry Caddy" }
            },
            "Ryan Hohn": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-23": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "No Caddy" }
            },
            "Vikas Bhasin": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "Carry Caddy", "PM": "Carry Caddy" },
                "2025-08-22": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-23": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "Carry Caddy" }
            },
            "Will Quarles": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "Carry Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-23": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "Not Playing" }
            },
            "Zach Deines": {
                "2025-08-20": { "PM": "No Caddy" },
                "2025-08-21": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-22": { "AM": "Not Playing", "PM": "No Caddy" },
                "2025-08-23": { "AM": "No Caddy", "PM": "No Caddy" },
                "2025-08-24": { "AM": "No Caddy" }
            }
        };

        // Rooming data parsed from the provided CSV file
        const roomingData = {
            "Matt Akers": { accommodation: "Golf Double", roommate: "Andrew Akers" },
            "Andrew Akers": { accommodation: "Golf Double", roommate: "Matt Akers" },
            "Bob Owlett": { accommodation: "Golf Double", roommate: "Kevan Oyama" },
            "Kevan Oyama": { accommodation: "Golf Double", roommate: "Bob Owlett" },
            "Brandon Itaoka": { accommodation: "Golf Double", roommate: "Cory Micheel" },
            "Cory Micheel": { accommodation: "Golf Double", roommate: "Brandon Itaoka" },
            "Charlie Hildebrand": { accommodation: "Golf Double", roommate: "Hisham Sayeedi" },
            "Hisham Sayeedi": { accommodation: "Golf Double", roommate: "Charlie Hildebrand" },
            "Cory Higgins": { accommodation: "Golf Double", roommate: "Will Quarles" },
            "Will Quarles": { accommodation: "Golf Double", roommate: "Cory Higgins" },
            "Daniel Passino": { accommodation: "Golf Double", roommate: "Vikas Bhasin" },
            "Vikas Bhasin": { accommodation: "Golf Double", roommate: "Daniel Passino" },
            "Jacob Emert": { accommodation: "Golf Double", roommate: "Zach Deines" },
            "Zach Deines": { accommodation: "Golf Double", roommate: "Jacob Emert" },
            "James Adolfson": { accommodation: "Golf Double", roommate: "Paul Parker" },
            "Paul Parker": { accommodation: "Golf Double", roommate: "James Adolfson" },
            "Johnathn Resetar": { accommodation: "Golf Double", roommate: "Ryan Hohn" },
            "Ryan Hohn": { accommodation: "Golf Double", roommate: "Johnathn Resetar" },
            "Kevin Newell": { accommodation: "Golf Double", roommate: "Mike Newell" },
            "Mike Newell": { accommodation: "Golf Double", roommate: "Kevin Newell" },
            "Nick Zangardi": { accommodation: "Golf Double", roommate: "Rob Small" },
            "Rob Small": { accommodation: "Golf Double", roommate: "Nick Zangardi" },
            "Bryan Wolfe": { accommodation: "Chrome King", roommate: "None" },
            "AD Hoffman": { accommodation: "Chrome King", roommate: "None" }
        };

        // Handicap data
        const handicaps = {
            "Mike Newell": 0.0,
            "Andrew Akers": 2,
            "James Adolfson": 3,
            "Cory Higgins": 3.3,
            "Kevan Oyama": 5,
            "Bob Owlett": 5,
            "Jacob Emert": 5.5,
            "Brandon Itaoka": 6.8,
            "Ryan Hohn": 7,
            "Zach Deines": 7.9,
            "Rob Small": 9,
            "Nick Zangardi": 8,
            "Vikas Bhasin": 11,
            "Daniel Passino": 11,
            "Hisham Sayeedi": 11,
            "Cory Micheel": 11,
            "AD Hoffman": 11,
            "Bryan Wolfe": 12,
            "Johnathn Resetar": 12.7,
            "Kevin Newell": 11.7,
            "Paul Parker": 13,
            "Will Quarles": 15,
            "Charlie Hildebrand": 15,
            "Matt Akers": 16.2
        };
        // Actual scores for all days
        const allScoresData = {
            "2025-08-20": {
                "Mike Newell": 25, "Jacob Emert": 50, "Brandon Itaoka": 49, "Kevin Newell": 48,
                "Cory Micheel": 47, "Matt Akers": 46, "Andrew Akers": 45, "Bob Owlett": 44,
                "Zach Deines": 43, "Daniel Passino": 42, "AD Hoffman": 41, "Will Quarles": 40,
                "James Adolfson": 39, "Kevan Oyama": 38, "Rob Small": 37, "Hisham Sayeedi": 36,
                "Bryan Wolfe": 35, "Charlie Hildebrand": 34, "Cory Higgins": 33, "Ryan Hohn": 32,
                "Nick Zangardi": 31, "Vikas Bhasin": 30, "Johnathn Resetar": 29, "Paul Parker": 28
            },
            "2025-08-21": {
                "Mike Newell": 31, "Andrew Akers": 52, "James Adolfson": 34, "Cory Higgins": 35,
                "Kevan Oyama": 29, "Bob Owlett": 30, "Brandon Itaoka": 55, "Jacob Emert": 36,
                "Ryan Hohn": 32, "Zach Deines": 44, "Rob Small": 26, "Nick Zangardi": 47,
                "Vikas Bhasin": 31, "Hisham Sayeedi": 36, "Daniel Passino": 25, "Kevin Newell": 38,
                "Cory Micheel": 52, "AD Hoffman": 42, "Johnathn Resetar": 42, "Bryan Wolfe": 36,
                "Paul Parker": 48, "Charlie Hildebrand": 42, "Will Quarles": 46, "Matt Akers": 51
            },
            "2025-08-22": {
                "Mike Newell": 34, "Andrew Akers": 34, "James Adolfson": 40, "Cory Higgins": 25,
                "Kevan Oyama": 46, "Bob Owlett": 41, "Brandon Itaoka": 27, "Jacob Emert": 43,
                "Ryan Hohn": 52, "Zach Deines": 37, "Rob Small": 33, "Nick Zangardi": 36,
                "Vikas Bhasin": 44, "Hisham Sayeedi": 31, "Daniel Passino": 46, "Kevin Newell": 37,
                "Cory Micheel": 36, "AD Hoffman": 27, "Johnathn Resetar": 39, "Bryan Wolfe": 55,
                "Paul Parker": 53, "Charlie Hildebrand": 49, "Will Quarles": 32, "Matt Akers": 43
            },
            "2025-08-23": {
                "Mike Newell": 39, "Andrew Akers": 47, "James Adolfson": 36, "Cory Higgins": 46,
                "Kevan Oyama": 53, "Bob Owlett": 30, "Brandon Itaoka": 38, "Jacob Emert": 40,
                "Ryan Hohn": 34, "Zach Deines": 49, "Rob Small": 47, "Nick Zangardi": 25,
                "Vikas Bhasin": 38, "Hisham Sayeedi": 51, "Daniel Passino": 31, "Kevin Newell": 47,
                "Cory Micheel": 29, "AD Hoffman": 50, "Johnathn Resetar": 55, "Bryan Wolfe": 32,
                "Paul Parker": 33, "Charlie Hildebrand": 35, "Will Quarles": 29, "Matt Akers": 42
            },
            "2025-08-24": {
                "Mike Newell": 45, "Andrew Akers": 55, "James Adolfson": 55, "Cory Higgins": 44,
                "Kevan Oyama": 38, "Bob Owlett": 51, "Brandon Itaoka": 50, "Jacob Emert": 26,
                "Ryan Hohn": 49, "Zach Deines": 47, "Rob Small": 36, "Nick Zangardi": 55,
                "Vikas Bhasin": 31, "Hisham Sayeedi": 26, "Daniel Passino": 52, "Kevin Newell": 36,
                "Cory Micheel": 38, "AD Hoffman": 39, "Johnathn Resetar": 45, "Bryan Wolfe": 29,
                "Paul Parker": 54, "Charlie Hildebrand": 43, "Will Quarles": 44, "Matt Akers": 30
            }
        };
        // Meal data
        const mealsData = {
            "Kevin Newell": { "Breakfast Buffet": 1, "Lunch Box": 1 },
            "Ryan Hohn": { "Breakfast Buffet": 1, "Lunch Box": 1 },
            "Johnathn Resetar": { "Breakfast Buffet": 1, "Lunch Box": 1 },
            "Charlie Hildebrand": { "Breakfast Buffet": 1, "Lunch Box": 1 },
            "Rob Small": { "Breakfast Buffet": 1, "Lunch Box": 1 },
            "Mike Newell": { "Breakfast Buffet": 0, "Lunch Box": 1 },
            "Cory Higgins": { "Breakfast Buffet": 0, "Lunch Box": 1 },
            "Zach Deines": { "Breakfast Buffet": 0, "Lunch Box": 1 },
            "Vikas Bhasin": { "Breakfast Buffet": 0, "Lunch Box": 1 },
            "Jacob Emert": { "Breakfast Buffet": 0, "Lunch Box": 1 },
            "Brandon Itaoka": { "Breakfast Buffet": 0, "Lunch Box": 1 },
            "Nick Zangardi": { "Breakfast Buffet": 0, "Lunch Box": 1 },
            "Andrew Akers": { "Breakfast Buffet": 0, "Lunch Box": 1 },
            "Hisham Sayeedi": { "Breakfast Buffet": 0, "Lunch Box": 1 },
            "Daniel Passino": { "Breakfast Buffet": 0, "Lunch Box": 0 },
            "Matt Akers": { "Breakfast Buffet": 0, "Lunch Box": 0 },
            "Bryan Wolfe": { "Breakfast Buffet": 0, "Lunch Box": 0 },
            "Bob Owlett": { "Breakfast Buffet": 0, "Lunch Box": 0 },
            "Kevan Oyama": { "Breakfast Buffet": 0, "Lunch Box": 0 },
            "Cory Micheel": { "Breakfast Buffet": 0, "Lunch Box": 0 },
            "AD Hoffman": { "Breakfast Buffet": 0, "Lunch Box": 0 },
            "Paul Parker": { "Breakfast Buffet": 0, "Lunch Box": 0 },
            "James Adolfson": { "Breakfast Buffet": 0, "Lunch Box": 0 },
            "Will Quarles": { "Breakfast Buffet": 0, "Lunch Box": 0 }
        };
        // Global variables
        const caddySelectionsByPlayerRound = {};
        let dailyTeams = {};
        let dailyScores = {};
        const scoringDates = ['2025-08-20', '2025-08-21', '2025-08-22', '2025-08-23', '2025-08-24'];

        // CSV parsing function
        function parseCSV(csv) {
            const lines = csv.split('\n').filter(line => line.trim() !== '');
            if (lines.length < 2) return [];

            const data = [];
            const headers = lines[0].split(',');
            const dateIndex = headers.findIndex(h => h.trim() === 'Date');
            const timeIndex = headers.findIndex(h => h.trim() === 'Time');
            const courseIndex = headers.findIndex(h => h.trim() === 'Course');
            const playerIndices = [
                headers.findIndex(h => h.trim() === 'Player1'),
                headers.findIndex(h => h.trim() === 'Player2'),
                headers.findIndex(h => h.trim() === 'Player3'),
                headers.findIndex(h => h.trim() === 'Player4'),
                headers.findIndex(h => h.trim() === 'Player5')
            ].filter(i => i !== -1);
            const notesIndex = headers.findIndex(h => h.trim() === 'Notes');

            for (let i = 1; i < lines.length; i++) {
                const currentLine = lines[i].split(',');
                const row = {};
                row['Date'] = currentLine[dateIndex] ? currentLine[dateIndex].trim() : '';
                row['Time'] = currentLine[timeIndex] ? currentLine[timeIndex].trim() : '';
                row['Course'] = currentLine[courseIndex] ? currentLine[courseIndex].trim() : '';
                row['Notes'] = notesIndex > -1 && currentLine[notesIndex] ? currentLine[notesIndex].trim() : '';
                
                let players = [];
                playerIndices.forEach((pIndex, idx) => {
                    const playerName = currentLine[pIndex] ? currentLine[pIndex].trim() : '';
                    if (playerName) {
                        players[idx] = playerName;
                    }
                });
                row['Players'] = players;

                if (row['Date'] && row['Time'] && row['Course'] && players.length > 0) {
                    data.push(row);
                }
            }
            return data;
        }


        // Caddy CSV parsing - now replaced with direct data mapping
        function parseCaddyWorkbookCSV() {
            // Simply use the complete caddy data directly
            Object.keys(completeCaddyData).forEach(playerName => {
                caddySelectionsByPlayerRound[playerName] = completeCaddyData[playerName];
            });
        }

        function populatePlayerSelect(players) {
            const playerSelect = document.getElementById('player-select');
            if (playerSelect) {
                playerSelect.innerHTML = '';
                const sortedPlayers = [...players].sort();
                sortedPlayers.forEach(player => {
                    const option = document.createElement('option');
                    option.value = player;
                    option.textContent = player;
                    playerSelect.appendChild(option);
                });
            }
        }

        function populateNotes(playerName) {
            const notesBody = document.getElementById('notes-table-body');
            notesBody.innerHTML = '';

            const staticNotes = ["Welcome dinner at Trail's End 8:30 p.m."];
            staticNotes.forEach(note => {
                const tr = document.createElement('tr');
                const td = document.createElement('td');
                td.className = 'border px-4 py-2';
                td.textContent = note;
                tr.appendChild(td);
                notesBody.appendChild(tr);
            });

            const playerMeals = mealsData[playerName];
            if (playerMeals) {
                const breakfastStatus = playerMeals["Breakfast Buffet"] === 1 ? "Yes" : "No";
                const lunchStatus = playerMeals["Lunch Box"] === 1 ? "Yes" : "No";

                let trBreakfast = document.createElement('tr');
                let tdBreakfast = document.createElement('td');
                tdBreakfast.className = 'border px-4 py-2';
                tdBreakfast.textContent = `Breakfast: ${breakfastStatus}`;
                trBreakfast.appendChild(tdBreakfast);
                notesBody.appendChild(trBreakfast);

                let trLunch = document.createElement('tr');
                let tdLunch = document.createElement('td');
                tdLunch.className = 'border px-4 py-2';
                tdLunch.textContent = `Lunch: ${lunchStatus}`;
                trLunch.appendChild(tdLunch);
                notesBody.appendChild(trLunch);
            }

            const playerRoomingInfo = roomingData[playerName];
            if (playerRoomingInfo) {
                let trAccommodations = document.createElement('tr');
                let tdAccommodations = document.createElement('td');
                tdAccommodations.className = 'border px-4 py-2';
                tdAccommodations.textContent = `Accommodations: ${playerRoomingInfo.accommodation}`;
                trAccommodations.appendChild(tdAccommodations);
                notesBody.appendChild(trAccommodations);

                let trRoommate = document.createElement('tr');
                let tdRoommate = document.createElement('td');
                tdRoommate.className = 'border px-4 py-2';
                tdRoommate.textContent = `Roommate: ${playerRoomingInfo.roommate}`;
                trRoommate.appendChild(tdRoommate);
                notesBody.appendChild(trRoommate);
            }
        }

        function populateTeeTimesForPlayer(playerName) {
            const pairingsBody = document.getElementById('tee-time-pairings-body');
            const currentPlayerTitle = document.getElementById('current-player-tee-times-title');
            const mainTripSummaryTitle = document.getElementById('main-trip-summary-title');
            const stablefordTableBody = document.querySelector('#stableford-table tbody');
            const parsedData = parseCSV(csvData);

            mainTripSummaryTitle.textContent = `${playerName} - Bandon Dunes Golf Trip Summary`;
            currentPlayerTitle.textContent = `${playerName}'s Tee Time Pairings`;
            pairingsBody.innerHTML = '';

            const existingHandicapRow = stablefordTableBody.querySelector('.player-handicap-row');
            if (existingHandicapRow) existingHandicapRow.remove();
            const existingSpacingRow = stablefordTableBody.querySelector('.spacing-row');
            if (existingSpacingRow) existingSpacingRow.remove();

            const spacingTr = document.createElement('tr');
            spacingTr.className = 'spacing-row';
            spacingTr.innerHTML = '<td colspan="4"></td>';
            stablefordTableBody.appendChild(spacingTr);

            const playerHandicap = handicaps[playerName];
            if (playerHandicap !== undefined) {
                const tr = document.createElement('tr');
                tr.className = 'player-handicap-row';
                tr.innerHTML = `<td class="border px-4 py-2 font-semibold">${playerName}'s Handicap</td><td class="border px-4 py-2 bg-white">${playerHandicap.toFixed(1)}</td><td class="border px-4 py-2 bg-white" colspan="2"></td>`;
                stablefordTableBody.appendChild(tr);
            }

            let playerTeeTimes = parsedData.filter(row => row.Players.includes(playerName));

            playerTeeTimes.sort((a, b) => {
                const dateA = new Date(`${a['Date']} ${a['Time'].replace(/\./g, '')}`);
                const dateB = new Date(`${b['Date']} ${b['Time'].replace(/\./g, '')}`);
                return dateA - dateB;
            });

            playerTeeTimes.forEach(row => {
                const tr = document.createElement('tr');
                const dateObj = new Date(row['Date'].replace(/-/g, '/'));
                const dateTd = document.createElement('td');
                dateTd.className = 'px-4 py-2';
                dateTd.textContent = dateObj.toLocaleDateString('en-US', { weekday: 'short', month: 'numeric', day: 'numeric' }).replace(',', ' -');
                tr.appendChild(dateTd);

                const timeTd = document.createElement('td');
                timeTd.className = 'px-4 py-2';
                timeTd.textContent = row['Time'];
                tr.appendChild(timeTd);

                const completeTimeTd = document.createElement('td');
                completeTimeTd.className = 'px-4 py-2';
                completeTimeTd.textContent = 'N/A'; // This column is no longer in the new CSV
                tr.appendChild(completeTimeTd);

                const courseTd = document.createElement('td');
                courseTd.className = 'px-4 py-2';
                courseTd.textContent = row['Course'];
                tr.appendChild(courseTd);

                let teeTimeAmPm = row['Time'].toLowerCase().includes('p.m.') ? 'PM' : 'AM';
                let caddyTypeForRound = completeCaddyData[playerName]?.[row['Date']]?.[teeTimeAmPm] || 'N/A';
                const caddieTd = document.createElement('td');
                caddieTd.className = 'px-4 py-2';
                caddieTd.textContent = caddyTypeForRound;
                tr.appendChild(caddieTd);

                const partnersTd = document.createElement('td');
                partnersTd.className = 'px-4 py-2';
                const partners = row.Players
                    .filter(p => p && p !== playerName && p !== 'TBD')
                    .map(p => `${p} (${handicaps[p] !== undefined ? handicaps[p].toFixed(1) : 'N/A'})`)
                    .join(', ');
                partnersTd.textContent = partners;
                tr.appendChild(partnersTd);
                pairingsBody.appendChild(tr);
            });
        }

        function populateDailyPairings() {
            const dailyPairingsBody = document.getElementById('daily-pairings-body');
            dailyPairingsBody.innerHTML = '';
            const parsedData = parseCSV(csvData);

            const pairingsByDate = {};
            parsedData.forEach(row => {
                if (!pairingsByDate[row.Date]) pairingsByDate[row.Date] = [];
                pairingsByDate[row.Date].push(row);
            });

            Object.keys(pairingsByDate).sort().forEach(date => {
                const dailyPairings = pairingsByDate[date].sort((a,b) => new Date(`${a.Date} ${a.Time.replace(/\./g, '')}`) - new Date(`${b.Date} ${b.Time.replace(/\./g, '')}`));
                dailyPairings.forEach((row, index) => {
                    const tr = document.createElement('tr');
                    if (index === dailyPairings.length - 1) {
                        tr.className = 'last-tee-time-of-day';
                    }
                    
                    const dateObj = new Date(row.Date.replace(/-/g, '/'));
                    tr.innerHTML = `
                        <td class="px-4 py-2">${dateObj.toLocaleDateString('en-US', { weekday: 'short', month: 'numeric', day: 'numeric' }).replace(',', ' -')}</td>
                        <td class="px-4 py-2">${row.Time}</td>
                        <td class="px-4 py-2">N/A</td>
                        <td class="px-4 py-2">${row.Course}</td>
                        <td class="px-4 py-2">${row.Players.filter(p => p && p !== 'TBD').map(p => `${p} (${handicaps[p] !== undefined ? handicaps[p].toFixed(1) : 'N/A'})`).join('<br>')}</td>
                    `;
                    dailyPairingsBody.appendChild(tr);
                });
            });
        }

        function populateCaddySummary() {
            const caddySummaryBody = document.getElementById('caddy-summary-body');
            const caddySummaryHeaderRow = document.getElementById('caddy-summary-header-row');
            caddySummaryBody.innerHTML = '';
            caddySummaryHeaderRow.innerHTML = '<th class="px-4 py-2">Player</th>';

            const players = Object.keys(handicaps).sort();
            
            // Define the exact date/round combinations we want to show
            const dateRounds = [
                { date: '2025-08-20', round: 'PM', label: 'Wed 8/20 (PM)' },
                { date: '2025-08-21', round: 'AM', label: 'Thu 8/21 (AM)' },
                { date: '2025-08-21', round: 'PM', label: 'Thu 8/21 (PM)' },
                { date: '2025-08-22', round: 'AM', label: 'Fri 8/22 (AM)' },
                { date: '2025-08-22', round: 'PM', label: 'Fri 8/22 (PM)' },
                { date: '2025-08-23', round: 'AM', label: 'Sat 8/23 (AM)' },
                { date: '2025-08-23', round: 'PM', label: 'Sat 8/23 (PM)' },
                { date: '2025-08-24', round: 'AM', label: 'Sun 8/24 (AM)' }
            ];

            // Create headers
            dateRounds.forEach(dateRound => {
                const th = document.createElement('th');
                th.className = 'px-4 py-2';
                th.textContent = dateRound.label;
                caddySummaryHeaderRow.appendChild(th);
            });

            // Create rows for each player
            players.forEach(player => {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td class="px-4 py-2 font-semibold">${player}</td>`;
                
                dateRounds.forEach(dateRound => {
                    const caddyType = completeCaddyData[player]?.[dateRound.date]?.[dateRound.round] || 'N/A';
                    const caddyTd = document.createElement('td');
                    caddyTd.className = 'px-4 py-2';
                    caddyTd.textContent = caddyType;
                    tr.appendChild(caddyTd);
                });
                caddySummaryBody.appendChild(tr);
            });
        }

        function populateCaddySummaryByTeeTime() {
            const teeTimeSummaryBody = document.getElementById('caddy-tee-time-summary-body');
            if (!teeTimeSummaryBody) return;
            teeTimeSummaryBody.innerHTML = '';
            const parsedData = parseCSV(csvData);

            const teeTimesByDate = {};
            parsedData.forEach(row => {
                if (!teeTimesByDate[row.Date]) teeTimesByDate[row.Date] = [];
                teeTimesByDate[row.Date].push(row);
            });

            Object.keys(teeTimesByDate).sort().forEach(date => {
                const dailyTeeTimes = teeTimesByDate[date].sort((a,b) => new Date(`${a.Date} ${a.Time.replace(/\./g, '')}`) - new Date(`${b.Date} ${b.Time.replace(/\./g, '')}`));
                dailyTeeTimes.forEach((row, index) => {
                    const tr = document.createElement('tr');
                    const dateObj = new Date(row.Date.replace(/-/g, '/'));
                    let teeTimeAmPm = row['Time'].toLowerCase().includes('p.m.') ? 'PM' : 'AM';

                    const players = row.Players;
                    const playersWithCaddies = players.filter(p => p && p !== 'TBD').map(p => {
                        let caddyChoice = 'No Caddy';
                        if (row.Course !== "Shorty's" && row.Course !== "Bandon Preserve") {
                            caddyChoice = completeCaddyData[p]?.[date]?.[teeTimeAmPm] || 'No Caddy';
                        }
                        return `${p} - ${caddyChoice}`;
                    });

                    const caddyCounts = players.reduce((counts, player) => {
                        if (player && player !== 'TBD') {
                            let caddyChoice = 'No Caddy';
                            if (row.Course !== "Shorty's" && row.Course !== "Bandon Preserve") {
                                caddyChoice = completeCaddyData[player]?.[date]?.[teeTimeAmPm] || 'No Caddy';
                            }
                            if (caddyChoice !== 'No Caddy' && caddyChoice !== 'Not Playing') {
                                counts[caddyChoice] = (counts[caddyChoice] || 0) + 1;
                            }
                        }
                        return counts;
                    }, {});

                    const summaryString = Object.keys(caddyCounts).map(type => `${type}: ${caddyCounts[type]}`).join(', ') || 'No Caddies';
                    
                    tr.innerHTML = `
                        <td class="px-4 py-2">${dateObj.toLocaleDateString('en-US', { weekday: 'short', month: 'numeric', day: 'numeric' }).replace(',', ' -')}</td>
                        <td class="px-4 py-2">${row.Time}</td>
                        <td class="px-4 py-2">${row.Course}</td>
                        <td class="px-4 py-2">${playersWithCaddies.join('<br>')}</td>
                        <td class="px-4 py-2">${summaryString}</td>
                    `;
                    teeTimeSummaryBody.appendChild(tr);

                    if (index === dailyTeeTimes.length - 1) {
                        const separatorTr = document.createElement('tr');
                        separatorTr.className = 'caddy-summary-separator';
                        separatorTr.innerHTML = '<td colspan="5"></td>';
                        teeTimeSummaryBody.appendChild(separatorTr);
                    }
                });
            });
        }

        function createDailyTeams(players, previousDayScores) {
            let playersWithRank = [];
            const numTeams = 6;
            const teams = Array.from({ length: numTeams }, () => []);

            if (!previousDayScores) {
                playersWithRank = players.map(name => ({ name, handicap: handicaps[name], score: null }));
                playersWithRank.sort((a, b) => a.handicap - b.handicap);
            } else {
                playersWithRank = players.map(name => ({ name, handicap: handicaps[name], score: previousDayScores[name] }));
                playersWithRank.sort((a, b) => {
                    if (b.score !== a.score) {
                        return b.score - a.score;
                    }
                    return a.handicap - b.handicap;
                });
            }

            for (let i = 0; i < playersWithRank.length; i++) {
                const player = playersWithRank[i];
                const teamIndex = Math.floor(i / numTeams) % 2 === 0 ? i % numTeams : numTeams - 1 - (i % numTeams);
                teams[teamIndex].push(player);
            }
            return teams;
        }

        function populateScoringTable(date, teamsForDay, scoresForDay) {
            const dateSuffix = date.substring(5).replace(/-/g, '-');
            const scoringBody = document.getElementById(`scoring-body-${dateSuffix}`);
            if (!scoringBody) return;
            scoringBody.innerHTML = '';

            const teamTotals = teamsForDay.map(team => team.reduce((sum, player) => sum + (scoresForDay[player.name] || 0), 0));
            const winningTeamScore = Math.max(...teamTotals);

            teamsForDay.forEach((team, teamIndex) => {
                const teamTotalScore = teamTotals[teamIndex];
                team.forEach((player, playerIndex) => {
                    const playerScore = scoresForDay[player.name] || 'N/A';
                    const tr = document.createElement('tr');
                    if (teamTotalScore === winningTeamScore) {
                        tr.classList.add('winning-team-highlight');
                    }
                    let rowHtml = '';
                    if (playerIndex === 0) {
                        rowHtml += `<td rowspan="${team.length}" class="px-4 py-2 team-header">Team ${teamIndex + 1}</td>`;
                    }
                    rowHtml += `
                        <td class="px-4 py-2">${player.name}</td>
                        <td class="px-4 py-2">${player.handicap.toFixed(1)}</td>
                        <td class="px-4 py-2">${playerScore}</td>
                    `;
                    if (playerIndex === 0) {
                        rowHtml += `<td rowspan="${team.length}" class="px-4 py-2 font-bold">${teamTotalScore}</td>`;
                    }
                    tr.innerHTML = rowHtml;
                    scoringBody.appendChild(tr);
                });
            });
        }

        function populateDailyFlow(playerName) {
            const header = document.getElementById('daily-flow-header');
            const body = document.getElementById('daily-flow-body');
            const dailyFlowTitle = document.querySelector('#content-daily-flow .card h2');
            
            header.innerHTML = '';
            body.innerHTML = '';
            
            // Update the title to include player name
            dailyFlowTitle.textContent = `Daily Flow - ${playerName}`;

            const dates = [...new Set(parseCSV(csvData).map(row => row.Date))].sort();
            let headerRow = '<tr><th class="px-2 py-1">Time</th>';
            dates.forEach(date => {
                const d = new Date(date.replace(/-/g, '/'));
                headerRow += `<th class="px-2 py-1">${d.toLocaleDateString('en-US', { weekday: 'short', month: 'numeric', day: 'numeric' })}</th>`;
            });
            headerRow += '</tr>';
            header.innerHTML = headerRow;

            const playerTeeTimes = parseCSV(csvData).filter(row => row.Players.includes(playerName));

            // Changed from 6-20 hours to 7-20 hours, and 30-minute to 15-minute increments
            for (let hour = 7; hour <= 20; hour++) {
                for (let minute = 0; minute < 60; minute += 15) {
                    const time = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
                    let rowHtml = `<tr><td class="px-2 py-1 font-mono text-xs">${time}</td>`;

                    dates.forEach(date => {
                        let cellContent = '';
                        let cellClass = 'bg-gray-100'; // Default gray for empty cells
                        const now = new Date(`${date} ${time}`);

                        // Check for group dinner on 8/20 at 20:30
                        if (date === '2025-08-20' && time === '20:30') {
                            cellContent = 'Trails End Grill - Group Dinner';
                            cellClass = 'bg-purple-200';
                        } else {
                            const dailyTeeTimes = playerTeeTimes.filter(tt => tt.Date === date).sort((a, b) =>
                                 new Date(`${a.Date} ${a.Time.replace(/\./g, '')}`) - new Date(`${b.Date} ${b.Time.replace(/\./g, '')}`)
                            );

                            let foundActivity = false;
                            
                            for(let i = 0; i < dailyTeeTimes.length; i++) {
                                const tt = dailyTeeTimes[i];
                                const startTime = new Date(`${tt.Date} ${tt.Time.replace(/\./g, '')}`);
                                let durationHours = 4.5; // Default duration
                                if (tt.Course === "Bandon Preserve" || tt.Course === "Shorty's") {
                                    durationHours = 2;
                                }
                                const endTime = new Date(startTime.getTime() + durationHours * 60 * 60 * 1000);
                                                                
                                if (now >= startTime && now < endTime) {
                                    if(Math.abs(now - startTime) < 15 * 60 * 1000) {
                                        cellContent = `${tt.Time} - ${tt.Course}`;
                                    } else {
                                        cellContent = tt.Course;
                                    }
                                    cellClass = 'bg-blue-200'; // Blue for active rounds
                                    foundActivity = true;
                                    break;
                                }

                                if (i + 1 < dailyTeeTimes.length) {
                                    const nextTeeTime = new Date(`${dailyTeeTimes[i+1].Date} ${dailyTeeTimes[i+1].Time.replace(/\./g, '')}`);
                                    if (now >= endTime && now < nextTeeTime) {
                                        cellClass = 'bg-green-300'; // Green for free time
                                        cellContent = 'Free Time';
                                        foundActivity = true;
                                        break;
                                    }
                                }
                            }

                            // If no activity found, cell remains gray with empty content
                            if (!foundActivity) {
                                cellContent = '';
                                cellClass = 'bg-gray-100';
                            }
                        }
                        rowHtml += `<td class="px-2 py-1 text-xs ${cellClass}">${cellContent}</td>`;
                    });
                    rowHtml += '</tr>';
                    body.innerHTML += rowHtml;
                }
            }
        }

        function initialize() {
            const allPlayers = Object.keys(handicaps);
            parseCaddyWorkbookCSV();
            populatePlayerSelect(allPlayers);
            
            const initialPlayer = allPlayers.sort()[0];
            document.getElementById('player-select').value = initialPlayer;
            
            populateTeeTimesForPlayer(initialPlayer);
            populateNotes(initialPlayer);
            populateDailyPairings();
            populateCaddySummary();
            populateCaddySummaryByTeeTime();
            populateDailyFlow(initialPlayer);

            let previousDayScores = null;
            scoringDates.forEach(date => {
                const playersList = Object.keys(handicaps);
                dailyScores[date] = allScoresData[date];
                dailyTeams[date] = createDailyTeams(playersList, previousDayScores);
                populateScoringTable(date, dailyTeams[date], dailyScores[date]);
                previousDayScores = dailyScores[date];
            });

            document.getElementById('player-select').addEventListener('change', (event) => {
                const selectedPlayer = event.target.value;
                populateTeeTimesForPlayer(selectedPlayer);
                populateNotes(selectedPlayer);
                populateDailyFlow(selectedPlayer);
            });

            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', () => {
                    document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                    button.classList.add('active');
                    document.getElementById(button.id.replace('tab-', 'content-')).classList.add('active');
                });
            });
        }

        window.onload = initialize;
    </script>
</body>
</html>
